services:
  front:
    env_file: ./.env
    image: maratms-prod
    networks: [maratms-com-network]
    restart: unless-stopped

  cloudflared:
    image: cloudflare/cloudflared:latest
    env_file: ./.env
    command: tunnel --no-autoupdate run --token ${CF_TUNNEL_TOKEN}
    environment:
      - TUNNEL_METRICS=0.0.0.0:49999
    networks: [maratms-com-network]
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "cloudflared", "version"]
      interval: 30s
      timeout: 5s
      retries: 3

networks:
  maratms-com-network:
    driver: bridge
